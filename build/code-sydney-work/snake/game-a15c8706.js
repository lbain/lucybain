function Game(){var e,t,i,n,o="r",s=32,a=0,h=$("#level"),l=1,d=$("#food-till-next-level"),c=this;return this.init=function(){e=new Board("#board tbody",s),n=new Snake(s),i=new Food(s),e.display(),this.display(),this.paceMoves(),this.bindKeys()},this.paceMoves=function(){clearInterval(t),t=setInterval(function(){c.moveAndDisplay()},50*(5-a))},this.bindKeys=function(){$(document).keydown(function(e){newDirection={37:"l",38:"u",39:"r",40:"d"}[e.keyCode],c.oppositeDirection(newDirection)&&n.hasBody()?c.endGame():o=newDirection})},this.displayLevelInfo=function(){d.text(l),h.text(a)},this.display=function(){n.display(),i.display(),this.displayLevelInfo()},this.moveAndDisplay=function(){n.move(this.delta()),this.hitFood(),this.checkEndGame(),this.display()},this.changePosition=function(e){return{r:[1,0],l:[-1,0],u:[0,-1],d:[0,1]}[e]},this.oppositeDirection=function(e){return{r:"l",l:"r",u:"d",d:"u"}[o]===e},this.delta=function(){return this.changePosition(o)},this.hitEdge=function(){return n.head()[0]>s||n.head()[0]<0||n.head()[1]>s||n.head()[1]<0},this.checkEndGame=function(){(n.hitSelf()||this.hitEdge())&&this.endGame(!1)},this.endGame=function(e){clearInterval(t),this.displayFinal(e)},this.displayFinal=function(e){$("#board").fadeOut(),e?$(".level-info").text("You won!"):$(".level-info").text("You lost")},this.hitFood=function(){return!!n.hitCell(i.getLocation())&&(n.lengthen(this.delta()),i.removeDisplay(),i.generate(s),this.incrementLevel(),!0)},this.incrementLevel=function(){0===(l-=1)&&(l=a+=1,this.paceMoves()),4===this.level&&this.endGame(!0)},this.init()}$(function(){game=new Game});