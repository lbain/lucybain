function getRandomArbitrary(o){return Math.floor(Math.random()*o)}function Board(o,r){return this.gridSize=o,this.grid=[],this.bombCount=r,this.lost=!1,this.setupGrid(),this.generateBombs(),this}Board.prototype.isFinished=function(){return this.lost||this.isWon()},Board.prototype.isWon=function(){for(var o=!0,r=0;r<board.gridSize;r++)for(var t=0;t<board.gridSize;t++){var i=this.cellAtPos(r,t);o=o&&i.bomb!==i.found}return o},Board.prototype.setupGrid=function(){for(var o=0;o<this.gridSize;o++){this.grid[o]=[];for(var r=0;r<this.gridSize;r++)this.grid[o][r]=new Cell(o,r)}},Board.prototype.generateBombs=function(){for(var o=0;o<this.bombCount;o++){var r=this.randomPosition(),t=this.randomPosition(),i=this.cellAtPos(r,t);i.bomb&&o--,i.bomb=!0,this.updateCellCounts(i)}},Board.prototype.loopOverCellNeighbors=function(o,r){for(var t=o.row-1;t<=o.row+1;t++)for(var i=o.col-1;i<=o.col+1;i++){var e=this.cellAtPos(t,i);e&&r(e)}},Board.prototype.loopOverDirectCellNeighbors=function(o,r){for(var t=o.row-1;t<=o.row+1;t+=2)for(var i=o.col-1;i<=o.col+1;i+=2){var e=this.cellAtPos(t,i);e&&r(e)}},Board.prototype.updateCellCounts=function(o){this.loopOverCellNeighbors(o,function(o){o.count++})},Board.prototype.revealNearCells=function(o){var r=this;this.loopOverCellNeighbors(o,function(o){o.bomb||o.found||(o.find(),0===o.count&&r.revealNearCells(o))})},Board.prototype.makeMove=function(o,r){var t=this.cellAtPos(o,r);t.bomb?(this.lost=!0,t.find()):t.count>0?t.find():this.revealNearCells(t)},Board.prototype.flagCell=function(o,r){var t=this.cellAtPos(o,r);t&&t.flag(!t.flagged)},Board.prototype.randomPosition=function(){return getRandomArbitrary(this.gridSize)},Board.prototype.cellAtPos=function(o,r){var t=this.grid[o];return t?this.grid[o][r]:void 0};