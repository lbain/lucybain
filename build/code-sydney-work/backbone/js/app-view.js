var app=app||{};$(document).ready(function(){$("#todo-list").sortable({stop:function(t,e){e.item.trigger("drop",e.item.index())}})}),app.AppView=Backbone.View.extend({el:"#todoapp",initialize:function(){this.input=this.$("#new-todo"),app.todoList.on("add",this.addOne,this),app.todoList.on("reset",this.addAll,this),app.todoList.fetch()},events:{"keypress #new-todo":"createTodoOnEnter","update-sort":"updateSort"},createTodoOnEnter:function(t){13===t.which&&this.input.val().trim()&&(app.todoList.create(this.newAttributes()),this.input.val(""))},addOne:function(t){var e;e=t.get("ordinal")||0==t.get("ordinal")?t.get("ordinal"):app.todoList.length-1,t.set("ordinal",e);var i=new app.TodoView({model:t}),o=i.render().$el;o.data("model",t),$("#todo-list").append(o)},addAll:function(){this.$("#todo-list").html(""),app.todoList.each(this.addOne,this)},newAttributes:function(){return{title:this.input.val().trim(),completed:!1}},render:function(){return $("#todo-list").empty(),this.addAll(),this},updateSort:function(t,e,i){app.todoList.remove(e),app.todoList.each(function(t,e){var o=e;e>=i&&(o+=1),t.set("ordinal",o),t.save()}),e.set("ordinal",i),app.todoList.add(e,{at:i}),e.save(),this.render()}}),app.appView=new app.AppView;